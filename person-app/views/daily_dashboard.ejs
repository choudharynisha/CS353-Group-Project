<!DOCTYPE html>
<html lang = "en-US" dir = "ltr">
    <head>
        <title>Dashboard</title>
        <script src = "https://cdn.anychart.com/releases/8.9.0/js/anychart-base.min.js" type = "text/javascript"></script>
         <!-- <script src = "dashboard.js" type = "text/javascript"></script>  -->

        <style>
            body{
                background-color: rgb(113, 149, 160);;
               
            }
            .goalLists{
                float: left; 
                outline: black;
                outline-style: solid;
                
                text-align: center;
                margin-right: auto; 
                margin-left: auto;
                font-family: Arial;
            }
            button{
                font-family: Helvetica, sans-serif;
                font-size: 1.3em;
                color: white;

                border: none 0;
                border-radius: 5px;
                width: 100px; 
                height: 45px;
                padding: 5px 5px;
                margin: 5px 5px;
                cursor: pointer;
                
                text-align: center;

                background-color: #274946;
            
            }
        </style>
    </head>
    <body style="font-family: Arial, sans-serif;">
       
        
        <h1 style="text-align: center; ">  Dailies </h1>
        <br >
        <div id = "container" style = "width: 1200px; height: 600px; margin-right: auto; margin-left: auto;"></div>
        <br /><br />
      

        <br>
        <br>
        <h1 style="text-align: center; ">  Goals  </h1>

        <div style="width: 900px; height: 600px; margin-right: auto; margin-left: auto; ">
            <div class ="goalLists" id="dailygoals" style = " width: 300px; height: 400px; background-color: rgba(255, 255, 255, 0.8); overflow:auto; ">
              <br>
              <h3 style="text-align: center;">Daily Goals</h3>
      
              <ul style="color: black; "> 
                <% for( let i =0; i< test[1].length; i++){ %> 
                    <%if( test[1][i].type === 'daily'){ %>
                    <p style="text-align: center;"><%= test[1][i].description %></p> <% } }%>
                    
              </ul>
            </div>

            <div class ="goalLists" id="weeklygoals" style = " width: 300px; height: 400px; background-color: rgba(255, 255, 255, 0.8); overflow:auto;">
                <br>
                <h3 style="text-align: center;">Weekly Goals</h3>
      
                <ul style="color: black; "> 
                <% for( let i =0; i< test[1].length; i++){%> 
                    <%if( test[1][i].type === 'weekly'){ %>
                    <p style="text-align: center;"><%= test[1][i].description %></p> <%} }%>
        
                </ul>
            </div>
       
        
            <div class ="goalLists" id="monthlygoals" style = " width: 300px; height: 400px; background-color: rgba(255, 255, 255, 0.8); overflow:auto;">
                 <br>
                <h3 style="text-align: center; ">Monthly Goals</h3>
      
                <ul style="color: black; "> 
                <% for( let i =0; i< test[1].length; i++){%> 
                    <%if( test[1][i].type === 'monthly'){ %>
                    <p style="text-align: center;"><%= test[1][i].description %></p> <%  } }%>
        
                </ul>
            </div>

        </div>
        
        <br>
        <br>
        <br >

        <% 
            let today = new Date(); 
            let start = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000); 
            let lookingAt = [new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) , new Date(Date.now() - 6 * 24 * 60 * 60 * 1000), new Date(Date.now() - 5 * 24 * 60 * 60 * 1000), new Date(Date.now() - 4 * 24 * 60 * 60 * 1000), new Date(Date.now() - 3 * 24 * 60 * 60 * 1000), new Date(Date.now() - 2 * 24 * 60 * 60 * 1000), new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)]; 
        
            let data =[]; 
            for(let i = 0; i < test[0].length; i++)
            {
              
                let temp = []; 
                temp = test[0][i];
        %>
             
            <%

                if( start < temp[0] )
               {
                  // .toLocaleDateString()
                   let ob =[ temp[0].toLocaleDateString(), temp[1] ,  temp[2] ,  temp[3], temp[4]  , temp [5], "*" ]; 
                   
                 data.push(ob);
            %>
                 <!-- <%=temp[0]%>
                 <p><%= ob[0] %></p> -->
        <% 
               }
           
        
            }    
        
   
    
               
            let newlist = []; 
            data.reverse();
            let len = data.length-1; 
            while(newlist.length != len)
            {
                let temitem =0; 
                for(let i =1; i < data.length ; i++)
                {
                        temitem= data[i-1]; 
                       
                        if(data[i][0] < temitem[0] || data[i][0]  === temitem[0] )
                        {
                            if(data[i][0]  === temitem[0])
                            {
                               continue;
                                
                            }
                            else
                            {
                                temitem = data[i]; 
                            }
                        }
                        
                }
                 
                    newlist.push(temitem); 
              
                
      
                data = data.filter(item => item !== temitem);
            }
            data = newlist;

            
           
        %>

        
        <p><%= data %></p>
       




      
        


        <script>
           var data =[];
            data = "<%= data %>";
             let temptracker = data.split('*'); 


             console.log(temptracker);


            var start = "<%= start %>"   ;
            
            

            var tracker =[]; 
            
            for (var i = 0 ; i < temptracker.length; i++)
            {
                
                //tracker[i].replaceAll(" ", ""); 
                //console.log(temptracker[i]);
                if(i != 0)
                {
                    temptracker[i]= temptracker[i].substring( 1, temptracker[i].length); 
                }
                if(temptracker[i] === "0"  || temptracker[i] === ",0")
                {
                        continue; 
                }
                var tempdata =temptracker[i].split(',');
                let tem =[];
                
                
                 tracker.push(tempdata);
                
            }
             //console.log(tracker);

             
            
         anychart.onDocumentReady(function () {
                 
                var chart = anychart.line();
                chart.legend(true);

                 let dates =[]; 

                    let energy = []; 

                    let depression = [];  

                    let anxiety = [];  

                    let stress =[]; 

                    let motivation =[]; 

                for(let i =0; i < tracker.length; i++)
                {
                    //console.log(tracker[i]); 
                    
                    // dates
                    dates.push(tracker[i][0]); 
                    
                    // index 1 
                    if(tracker[i][1] !='')
                    {
                        energy.push(tracker[i][1]);
                    }
                    // index 2
                    if(tracker[i][2] != '')
                    {
                        depression.push(tracker[i][2]);
                    }
                    // index 3 
                    if(tracker[i][3] != '')
                    {
                        anxiety.push(tracker[i][3]); 
                    }
                    // index 4
                    if(tracker[i][4] != '')
                    {
                        stress.push(tracker[i][4]);
                    }
                    // index 5
                    if(tracker[i][5] != '')
                    {
                        motivation.push(tracker[i][5]); 
                    }    

                }

                //console.log(stress);

                let tempE=[]
                for(let i = 0; i < energy.length; i++)
                {
                            tempE.push({ x: dates[i], y: energy[i] });
                }
                //console.log(tempE);
                      
                var energyline = chart.line(tempE);
                energyline.name("Energy");


                let tempM=[]
                for(let i = 0; i < motivation.length; i++)
                {
                     tempM.push({ x: dates[i], y: motivation[i]});
                }
                //console.log(tempM);
                var motivationline = chart.line(tempM);
                motivationline.name("Motivation")
                    
                let tempS=[]
                for(let i = 0; i < stress.length; i++)
                {
                    tempS.push({ x: dates[i], y: stress[i]});
                }
                // console.log( "tempS" +tempS);
                var stressline = chart.line(tempS);
                stressline.name("Stress");
                
                let tempD=[]
                for(let i = 0; i < depression.length; i++)
                {
                    tempD.push({ x: dates[i], y: depression[i]});
                }
                
                var depline = chart.line(tempD);
                depline.name("Depression");

                let tempA=[]
                for(let i = 0; i < anxiety.length; i++)
                {
                    tempA.push({ x: dates[i], y: anxiety[i]});
                }
                
                var anxietyline = chart.line(tempA);
                anxietyline.name("Anxiety");
                

                chart.title('Tracker data ');
                
                chart.container('container');
                chart.draw();
         });

       
         </script>
        
      
    </body>
</html>